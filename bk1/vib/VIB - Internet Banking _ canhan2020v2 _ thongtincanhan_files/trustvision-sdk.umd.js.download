!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.trustvisionSdk={})}(this,function(t){"use strict";var e=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.post("/v1/read_id_card_info_sync",t)},t}(),n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function a(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}c((r=r.apply(t,e||[])).next())})}function i(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var o=function(){function t(t){this.httpClient=t}return t.prototype.uploadImage=function(t){return this.httpClient.postFormData("/v1/images",t)},t.prototype.request=function(t){return this.httpClient.postFormData("/v1/images",t)},t.prototype.requestWithHeaders=function(t,e){return this.httpClient.postFormData("/v1/images",t,e)},t.prototype.download=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return[4,this.httpClient.downloadFile("/v1/images/"+t)];case 1:return e=n.sent(),[4,URL.createObjectURL(e)];case 2:return[2,n.sent()]}})})},t.prototype.updateMetadata=function(t,e){return this.httpClient.patch("/v1/images/"+t,e)},t}(),s=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.post("/v1/compare_faces_sync",t)},t}(),a=function(){function t(t){this.httpClient=t}return t.prototype.getClientSettings=function(){return this.httpClient.get("/v1/client_settings")},t.prototype.request=function(){return this.httpClient.get("/v1/client_settings")},t}(),c=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.post("/v1/verify_face_liveness_sync",t)},t}(),u=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.post("/v1/search_faces_sync",t)},t.prototype.indexFaces=function(t){return this.httpClient.post("/v1/index_faces_sync",t)},t.prototype.downloadFaceImage=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return[4,this.httpClient.downloadFile("/v1/face_images/"+t)];case 1:return e=n.sent(),[4,URL.createObjectURL(e)];case 2:return[2,n.sent()]}})})},t}(),p=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.postFormData("/v1/convert_pdf_sync",t)},t}(),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(t,e){return t(e={exports:{}},e.exports),e.exports}var l=h(function(t){var e,n;e=f,n=function(){return function(){return function(t){var e=[];if(0===t.length)return"";if("string"!=typeof t[0])throw new TypeError("Url must be a string. Received "+t[0]);if(t[0].match(/^[^\/:]+:\/*$/)&&t.length>1){var n=t.shift();t[0]=n+t[0]}t[0].match(/^file:\/\/\//)?t[0]=t[0].replace(/^([^\/:]+):\/*/,"$1:///"):t[0]=t[0].replace(/^([^\/:]+):\/*/,"$1://");for(var r=0;r<t.length;r++){var i=t[r];if("string"!=typeof i)throw new TypeError("Url must be a string. Received "+i);""!==i&&(r>0&&(i=i.replace(/^[\/]+/,"")),i=r<t.length-1?i.replace(/[\/]+$/,""):i.replace(/[\/]+$/,"/"),e.push(i))}var o=e.join("/"),s=(o=o.replace(/\/(\?|&|#[^!])/g,"$1")).split("?");return s.shift()+(s.length>0?"?":"")+s.join("&")}("object"==typeof arguments[0]?arguments[0]:[].slice.call(arguments))}},t.exports?t.exports=n():e.urljoin=n()});function d(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var v=function(t,e,n,r){e=e||"&",n=n||"=";var i={};if("string"!=typeof t||0===t.length)return i;var o=/\+/g;t=t.split(e);var s=1e3;r&&"number"==typeof r.maxKeys&&(s=r.maxKeys);var a=t.length;s>0&&a>s&&(a=s);for(var c=0;c<a;++c){var u,p,f,h,l=t[c].replace(o,"%20"),v=l.indexOf(n);v>=0?(u=l.substr(0,v),p=l.substr(v+1)):(u=l,p=""),f=decodeURIComponent(u),h=decodeURIComponent(p),d(i,f)?Array.isArray(i[f])?i[f].push(h):i[f]=[i[f],h]:i[f]=h}return i},y=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},g=function(t,e,n,r){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(r){var i=encodeURIComponent(y(r))+n;return Array.isArray(t[r])?t[r].map(function(t){return i+encodeURIComponent(y(t))}).join(e):i+encodeURIComponent(y(t[r]))}).join(e):r?encodeURIComponent(y(r))+n+encodeURIComponent(y(t)):""},m=h(function(t,e){e.decode=e.parse=v,e.encode=e.stringify=g}),w=(m.decode,m.parse,m.encode,m.stringify),_=function(){function t(t){this.authorizer=t.authorizer,this.domain=t.domain,this.onError=t.onError}return t.prototype.get=function(t,e){var n=new URL(this.resolveUrl(t));return e&&(n.search=w(e)),this.request(n.toString(),{requestPath:t,method:"GET"})},t.prototype.post=function(t,e,r){var i=this.resolveUrl(t);return this.request(i,{requestPath:t,method:"POST",body:JSON.stringify(e),headers:n({"Content-Type":"application/json"},r)})},t.prototype.postFormData=function(t,e,n){var r,i=e instanceof FormData?e:(r=e,Object.entries(r).reduce(function(t,e){var n=e[0],r=e[1];return Array.isArray(r)?r.forEach(function(e,i){return t.append(n+"["+i+"]",r)}):!(r instanceof Object)||r instanceof File||r instanceof Date||r instanceof Blob?t.append(n,r):Object.entries(r).forEach(function(e,i){return t.append(n+"["+i+"]",r[i])}),t},new FormData)),o=this.resolveUrl(t);return this.request(o,{requestPath:t,method:"POST",body:i,headers:n})},t.prototype.patch=function(t,e){var n=this.resolveUrl(t);return this.request(n,{requestPath:t,method:"PATCH",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},t.prototype.delete=function(t,e){var n=this.resolveUrl(t);return this.request(n,{requestPath:t,method:"DELETE",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},t.prototype.downloadFile=function(t){var e=this.resolveUrl(t);return this.request(e,{requestPath:t,method:"GET"},"blob")},t.prototype.request=function(t,e,r){var i=this;void 0===r&&(r="json");var o={};return this.authorizer&&(o=this.authorizer.getHeaders(e)),e.headers=n(n({},e.headers),o),fetch(t,e).then(function(t){return"blob"===r?t.blob():t.json()}).then(function(t){if(t.errors&&i.onError)throw i.onError(t.errors),t;return t})},t.prototype.resolveUrl=function(t){return l(this.domain,t)},t}(),S=function(){function t(t){this.mocks=t}return t.prototype.get=function(t,e){return this.findInMocks(t,e)},t.prototype.post=function(t,e){return this.findInMocks(t)},t.prototype.postFormData=function(t,e){return this.findInMocks(t)},t.prototype.patch=function(t,e){return this.findInMocks(t)},t.prototype.delete=function(t,e){return this.findInMocks(t)},t.prototype.downloadFile=function(t){return this.findInMocks(t)},t.prototype.resolveUrl=function(t){return this.mocks.resolveUrl?this.mocks.resolveUrl(t):t},t.prototype.findInMocks=function(t,e){return r(this,void 0,void 0,function(){return i(this,function(n){return this.mocks[t]?"function"==typeof this.mocks[t]?[2,Promise.resolve(this.mocks[t](e))]:[2,Promise.resolve(this.mocks[t])]:[2,Promise.reject(new Error(t+" is not presented in mocks"))]})})},t}(),b=h(function(t,e){var n;t.exports=n=n||function(t,e){var n=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),r={},i=r.lib={},o=i.Base={extend:function(t){var e=n(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;e[r+o>>>2]|=s<<24-(r+o)%4*8}else for(o=0;o<i;o+=4)e[r+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=o.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n,r=[],i=function(e){e=e;var n=987654321,r=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&r)<<16)+(e=18e3*(65535&e)+(e>>16)&r)&r;return i/=4294967296,(i+=.5)*(t.random()>.5?1:-1)}},o=0;o<e;o+=4){var a=i(4294967296*(n||t.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new s.init(r,e)}}),a=r.enc={},c=a.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new s.init(n,e/2)}},u=a.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new s.init(n,e)}},p=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},f=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,r=n.words,i=n.sigBytes,o=this.blockSize,a=i/(4*o),c=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,u=t.min(4*c,i);if(c){for(var p=0;p<c;p+=o)this._doProcessBlock(r,p);var f=r.splice(0,c);n.sigBytes-=u}return new s.init(f,u)},clone:function(){var t=o.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),h=(i.Hasher=f.extend({cfg:o.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new h.HMAC.init(t,n).finalize(e)}}}),r.algo={});return r}(Math)}),C=h(function(t,e){var n,r,i;t.exports=(r=(n=i=b).lib.WordArray,n.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp();for(var i=[],o=0;o<n;o+=3)for(var s=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,a=0;a<4&&o+.75*a<n;a++)i.push(r.charAt(s>>>6*(3-a)&63));var c=r.charAt(64);if(c)for(;i.length%4;)i.push(c);return i.join("")},parse:function(t){var e=t.length,n=this._map,i=this._reverseMap;if(!i){i=this._reverseMap=[];for(var o=0;o<n.length;o++)i[n.charCodeAt(o)]=o}var s=n.charAt(64);if(s){var a=t.indexOf(s);-1!==a&&(e=a)}return function(t,e,n){for(var i=[],o=0,s=0;s<e;s++)if(s%4){var a=n[t.charCodeAt(s-1)]<<s%4*2,c=n[t.charCodeAt(s)]>>>6-s%4*2;i[o>>>2]|=(a|c)<<24-o%4*8,o++}return r.create(i,o)}(t,e,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)}),F=(h(function(t,e){var n;t.exports=(n=b,function(t){var e=n,r=e.lib,i=r.WordArray,o=r.Hasher,s=e.algo,a=[],c=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(a[i]=n(t.pow(r,.5))),c[i]=n(t.pow(r,1/3)),i++),r++}();var u=[],p=s.SHA256=o.extend({_doReset:function(){this._hash=new i.init(a.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],p=n[5],f=n[6],h=n[7],l=0;l<64;l++){if(l<16)u[l]=0|t[e+l];else{var d=u[l-15],v=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,y=u[l-2],g=(y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10;u[l]=v+u[l-7]+g+u[l-16]}var m=r&i^r&o^i&o,w=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),_=h+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&p^~a&f)+c[l]+u[l];h=f,f=p,p=a,a=s+_|0,s=o,o=i,i=r,r=_+(w+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+s|0,n[4]=n[4]+a|0,n[5]=n[5]+p|0,n[6]=n[6]+f|0,n[7]=n[7]+h|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=o.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=o._createHelper(p),e.HmacSHA256=o._createHmacHelper(p)}(Math),n.SHA256)}),h(function(t,e){var n,r,i;t.exports=(r=(n=b).lib.Base,i=n.enc.Utf8,void(n.algo.HMAC=r.extend({init:function(t,e){t=this._hasher=new t.init,"string"==typeof e&&(e=i.parse(e));var n=t.blockSize,r=4*n;e.sigBytes>r&&(e=t.finalize(e)),e.clamp();for(var o=this._oKey=e.clone(),s=this._iKey=e.clone(),a=o.words,c=s.words,u=0;u<n;u++)a[u]^=1549556828,c[u]^=909522486;o.sigBytes=s.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher,n=e.finalize(t);return e.reset(),e.finalize(this._oKey.clone().concat(n))}})))}),h(function(t,e){t.exports=b.HmacSHA256})),q=function(){function t(t,e){this.accessKey=t,this.keySecret=e}return t.prototype.getHeaders=function(t){var e=function(t){function e(t){return t<10?"0"+t:t}return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+"T"+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+(0===(n=t.getTimezoneOffset())?"Z":(r=n>0?"-":"+",n=Math.abs(n),r+e(Math.floor(n/60))+":"+e(n%60)));var n,r}(new Date);return{Authorization:this.generateAuthorization(t.requestPath,t.method,e),"X-TV-Timestamp":e}},t.prototype.generateAuthorization=function(t,e,n){var r=this.computeStringToSign(t,e,n),i=C.stringify(this.computeSignature(r));return this.formatAuthToken("TV",i)},t.prototype.formatAuthToken=function(t,e){return t+" "+this.accessKey+":"+e},t.prototype.computeStringToSign=function(t,e,n){return e+"\n"+t+"\n"+n},t.prototype.computeSignature=function(t){return F(t,this.keySecret)},t}();function x(t){switch(t){case"testing":return"https://tv-testing.trustingsocial.com/api";case"staging":return"https://tv-staging.trustingsocial.com/api";case"production":return"https://vn-vision.trustingsocial.com/api";case"uat":return"https://ekycapi-uat.vib.com.vn/api";case"live":return"https://ekycapi.vib.com.vn/api";default:return t}}function I(t,e,n){void 0===n&&(n="production");var r=new q(t,e),i=x(n);return new _({authorizer:r,domain:i})}var k=function(){function t(t){void 0===t&&(t="production");var e=new _({domain:x(t)});this.imagesService=new o(e)}return t.prototype.uploadImage=function(t,e){return this.imagesService.requestWithHeaders(t,e)},t}(),A=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.post("/v1/verify_id_card_sanity_sync",t)},t}(),B=function(){function t(t){this.httpClient=t}return t.prototype.request=function(t){return this.httpClient.post("/v1/verify_portrait_sanity_sync",t)},t}(),P=function(){function t(t,n,r){void 0===r&&(r="production");var i=I(t,n,r);this.compareFaceService=new s(i),this.clientSettingsService=new a(i),this.convertPDFService=new p(i),this.readIDCardService=new e(i),this.requestVerifyIDCardService=new A(i),this.requestVerifyPortraitSerivce=new B(i),this.imagesService=new o(i),this.verifyFaceLivenessService=new c(i),this.searchFaceService=new u(i)}return t.prototype.compareFaces=function(t){return this.compareFaceService.request(t)},t.prototype.clientSettings=function(){return this.clientSettingsService.request()},t.prototype.uploadImage=function(t){return this.imagesService.request(t)},t.prototype.convertPDF=function(t){return this.convertPDFService.request(t)},t.prototype.readIDCard=function(t){return this.readIDCardService.request(t)},t.prototype.requestVerifyIDCard=function(t){return this.requestVerifyIDCardService.request(t)},t.prototype.requestVerifyPortrait=function(t){return this.requestVerifyPortraitSerivce.request(t)},t.prototype.verifyFaceLiveness=function(t){return this.verifyFaceLivenessService.request(t)},t.prototype.searchFaces=function(t){return this.searchFaceService.request(t)},t.prototype.indexFaces=function(t){return this.searchFaceService.indexFaces(t)},t.prototype.downloadFaceImage=function(t){return this.searchFaceService.downloadFaceImage(t)},t.prototype.downloadImage=function(t){return this.imagesService.download(t)},t.prototype.updateMetadata=function(t,e){return this.imagesService.updateMetadata(t,e)},t}();t.ReadIDCard=e,t.UploadImage=o,t.CompareFaces=s,t.ClientSettings=a,t.VerifyFaceLiveness=c,t.SearchFaces=u,t.ConvertPDF=p,t.HttpClient=_,t.MockClient=S,t.TVAuthorizer=q,t.createHelpers=function(t,e,n){void 0===n&&(n="production");var r=new q(t,e),i=function(t){switch(n){case"testing":return"https://tv-testing.trustingsocial.com/api";case"staging":return"https://tv-staging.trustingsocial.com/api";case"uat":return"https://ekycapi-uat.vib.com.vn/api";case"live":return"https://ekycapi.vib.com.vn/api";case"production":default:return"https://vn-vision.trustingsocial.com/api"}}();return new _({authorizer:r,domain:i})},t.createHttpClient=I,t.SimpleTrustVisionAPI=k,t.default=P,Object.defineProperty(t,"__esModule",{value:!0})});